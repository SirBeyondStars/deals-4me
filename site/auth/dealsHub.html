
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Deals‑4Me — Deals Hub</title>
  <link rel="stylesheet" href="css/toolbarTheme.css" />
  <style>
    :root{
      --bg:#f9fafb; --ink:#0f172a; --muted:#64748b; --border:#e5e7eb; --card:#fff; --accent:#111827;
    }
    *{box-sizing:border-box}
    body { margin: 0; font-family: system-ui, Segoe UI, Roboto, Helvetica, Arial, sans-serif; background: var(--bg); color: var(--ink); }

    /* Shared header placeholder (your header.html will replace this) */
    .site-header{}

    /* Top sponsor ribbon */
    .sponsor-ribbon{
      position: sticky; top: 0; z-index: 8;
      background: #0b1220; color: #e5e7eb; border-bottom: 1px solid #1f2a44;
    }
    .ribbon-inner{max-width:1200px;margin:0 auto;padding:8px 12px;display:flex;gap:10px;align-items:center}
    .ribbon-slot{
      flex:1; min-height:44px; border:1px dashed #26406d; border-radius:10px; display:flex; align-items:center; justify-content:center;
      background:#0f172a; color:#93c5fd; font-size:.95rem;
    }

    /* Controls bar under sponsor ribbon */
    .controls{
      max-width:1200px; margin:10px auto; padding:0 12px;
    }
    .controls-inner{
      background:var(--card); border:1px solid var(--border); border-radius:14px; padding:10px 12px;
      display:grid; grid-template-columns: 1.2fr auto auto; gap:10px; align-items:center;
    }
    .row{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
    input[type="text"], select{ padding:10px; border:1px solid #cbd5e1; border-radius:10px; background:#fff; min-width:120px }
    .chip{border:1px solid #cbd5e1;background:#fff;border-radius:999px;padding:6px 10px;cursor:pointer;font-size:.95rem}
    .chip.active{background:#0f172a;color:#e2e8f0;border-color:#0f172a}

    /* Three-column layout */
    .layout{ display:grid; grid-template-columns: 280px 1fr 300px; gap:16px; max-width:1200px; margin:14px auto; padding:0 12px; }
    @media (max-width:1100px){ .layout{ grid-template-columns:260px 1fr } .right{ display:none } }
    @media (max-width:820px){ .layout{ grid-template-columns:1fr } .left{ order:2 } .center{ order:1 } }

    /* Cards */
    .card{ background:var(--card); border:1px solid var(--border); border-radius:14px; overflow:hidden }
    .hd{ padding:12px 14px; border-bottom:1px solid var(--border); font-weight:800 }
    .bd{ padding:12px 14px }
    .muted{ color:var(--muted) }
    .btn{ padding:8px 10px; border-radius:10px; border:1px solid #334155; background:var(--accent); color:#e5e7eb; cursor:pointer }
    .btn:hover{ background:#1f2937 }

    /* Left (ZIP + Stores) */
    .store-search{ display:flex; gap:8px; align-items:center }
    .store-list{ display:grid; gap:8px; margin-top:10px }
    .store-item{ display:flex; justify-content:space-between; align-items:center; border:1px solid var(--border); border-radius:10px; padding:8px 10px }
    .nm{ font-weight:600 }

    /* Center (Flyers/Deals/Trip Savings) */
    .section{ margin-bottom:16px }
    .deal-row{ display:grid; grid-template-columns:1fr auto; gap:10px; align-items:center; border-bottom:1px dashed var(--border); padding:8px 0 }
    .deal-row:last-child{ border-bottom:0 }
    .price{ font-weight:800 }

    /* Right (Savings tally) */
    .kpis{ display:grid; grid-template-columns:1fr 1fr; gap:10px }
    .kpi{ background:#0f172a; color:#e5e7eb; border-radius:12px; padding:12px }
    .kpi .v{ font-size:24px; font-weight:800 }
    .kpi .l{ font-size:.9rem; color:#cbd5e1 }
  </style>
</head>
<body>
  <!-- Load your shared header toolbar -->
  <div id="site-header" class="site-header"></div>
  <script>
    fetch('header.html').then(r => r.text()).then(html => {
      document.getElementById('site-header').innerHTML = html;
      window.initDealsHeader && window.initDealsHeader();
    }).catch(()=>{});
  </script>

  <!-- Sponsor ribbon (top strip below header) -->
  <div class="sponsor-ribbon" role="region" aria-label="Sponsor ribbon">
    <div class="ribbon-inner">
      <div class="ribbon-slot">Sponsor A</div>
      <div class="ribbon-slot">Sponsor B</div>
      <div class="ribbon-slot">Sponsor C</div>
    </div>
  </div>

  <!-- Controls: ZIP now grouped with Stores (left), timeframe dropdown stays here but drives Right KPI -->
  <div class="controls">
    <div class="controls-inner">
      <div class="row" id="zipRow">
        <input id="zipInput" type="text" placeholder="ZIP code" value="" />
        <select id="radius">
          <option value="5">5 mi</option>
          <option value="10" selected>10 mi</option>
          <option value="25">25 mi</option>
        </select>
        <button class="btn" id="applyZip">Update</button>
        <span class="muted">Area settings</span>
      </div>
      <div class="row" id="timeRow">
        <label class="muted" for="timeframe">Savings view:</label>
        <select id="timeframe">
          <option value="weekly" selected>Weekly</option>
          <option value="monthly">Monthly</option>
          <option value="quarterly">Quarterly</option>
          <option value="yearly">Yearly</option>
        </select>
      </div>
      <div class="row" role="group" aria-label="Quick filters">
        <button class="chip active">All</button>
        <button class="chip">Produce</button>
        <button class="chip">Meat</button>
        <button class="chip">Pantry</button>
        <button class="chip">Household</button>
      </div>
    </div>
  </div>

  <!-- Three column layout -->
  <div class="layout">
    <!-- Left: ZIP + Stores -->
    <aside class="left card" aria-label="Stores">
      <div class="hd">Stores near <span id="zipEcho" class="muted">—</span></div>
      <div class="bd">
        <div class="store-search">
          <input type="text" placeholder="Search stores…" aria-label="Search stores" style="flex:1; padding:10px; border:1px solid #cbd5e1; border-radius:10px">
          <button class="btn">Find</button>
        </div>
        <p class="muted" style="margin:8px 0 0">Pick a store to load its weekly flyer.</p>

        <div class="store-list" style="margin-top:10px">
          <div class="store-item">
            <div><div class="nm">Market Basket — Somerville</div><div class="muted">02143 • 1.2 mi</div></div>
            <button class="btn">Select</button>
          </div>
          <div class="store-item">
            <div><div class="nm">Shaw’s — Boylston St</div><div class="muted">02116 • 3.1 mi</div></div>
            <button class="btn">Select</button>
          </div>
          <div class="store-item">
            <div><div class="nm">Stop & Shop — Quincy</div><div class="muted">02169 • 7.4 mi</div></div>
            <button class="btn">Select</button>
          </div>
        </div>
      </div>
    </aside>

    <!-- Center: Flyers & Deals -->
    <section class="center">
      <article class="card section" aria-label="Flyer">
        <div class="hd">Flyer (Week of …)</div>
        <div class="bd">
          <p class="muted">Flyer metadata and highlights go here (valid dates, store name, top picks).</p>
          <div class="deal-row">
            <div><strong>Large Eggs 12ct</strong><div class="muted">dozen • pantry</div></div>
            <div class="price">$2.49</div>
          </div>
          <div class="deal-row">
            <div><strong>Chicken Breast</strong><div class="muted">lb • meat</div></div>
            <div class="price">$2.99</div>
          </div>
        </div>
      </article>

      <article class="card section" aria-label="Deals">
        <div class="hd">Deals</div>
        <div class="bd">
          <div class="deal-row">
            <div><strong>Romaine Lettuce</strong><div class="muted">each • produce</div></div>
            <div class="price">$1.29</div>
          </div>
          <div class="deal-row">
            <div><strong>Pasta 16oz</strong><div class="muted">box • pantry</div></div>
            <div class="price">$0.99</div>
          </div>
        </div>
      </article>
    </section>

    <!-- Right: Savings tally -->
    <aside class="right card" aria-label="Savings">
      <div class="hd">
        Savings — <span id="tfEcho">Weekly</span>
      </div>
      <div class="bd">
        <div class="kpis">
          <div class="kpi"><div class="v" id="kpiTotal">$18.40</div><div class="l">Total saved</div></div>
          <div class="kpi"><div class="v" id="kpiItems">7</div><div class="l">Items saved on</div></div>
          <div class="kpi"><div class="v" id="kpiTrips">2</div><div class="l">Trips</div></div>
          <div class="kpi"><div class="v" id="kpiBest">$5.00</div><div class="l">Best single deal</div></div>
        </div>
        <p class="muted" style="margin-top:10px">These are demo numbers. When wired, this will pull from your LP/deals DB and change with the timeframe.</p>
      </div>
    </aside>
  </div>

  <script>
    // Echo ZIP into the Stores card
    const zipInput = document.getElementById('zipInput');
    const zipEcho = document.getElementById('zipEcho');
    const applyZip = document.getElementById('applyZip');
    function setZipEcho(){
      zipEcho.textContent = zipInput.value ? zipInput.value : '—';
    }
    applyZip.addEventListener('click', setZipEcho);
    setZipEcho();

    // Timeframe -> update Savings header (demo only)
    const timeframe = document.getElementById('timeframe');
    const tfEcho = document.getElementById('tfEcho');
    timeframe.addEventListener('change', () => {
      const map = { weekly:'Weekly', monthly:'Monthly', quarterly:'Quarterly', yearly:'Yearly' };
      tfEcho.textContent = map[timeframe.value] || 'Weekly';
      // (Later: query and recompute KPIs here)
    });
  </script>
</body>
</html>
