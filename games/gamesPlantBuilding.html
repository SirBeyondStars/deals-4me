<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Deals-4Me · Plant Builder</title>
  <link rel="stylesheet" href="/theme.css">
  <script defer src="/theme.js"></script>
  <style>
    .wrap{padding:30px 0}
    .toolbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-bottom:12px}
    .seed{display:inline-flex;align-items:center;gap:6px;padding:8px 10px;border:1px solid var(--border);
      border-radius:12px;background:#fff;cursor:pointer}
    .seed.active{outline:2px solid #3ba3ff}
    .board{display:grid;gap:6px;background:#eaf0f7;border:1px solid var(--border);border-radius:12px;padding:8px}
    .cell{width:44px;height:44px;border-radius:8px;background:#fff;border:1px dashed #cbd5e1;
      display:flex;align-items:center;justify-content:center;font-size:22px}
    .legend{font-size:12px;color:var(--muted)}
    .btn--primary{background:var(--nav-pill);color:var(--nav-pill-ink);border:1px solid #1e8c67}
  </style>
</head>
<body>
  <div id="header"></div>

  <main class="container wrap">
    <section class="hero" style="margin-bottom:8px">
      <h1>Plant Builder</h1>
      <p class="muted">Design a tiny garden: pick a seed and click cells to plant. Try patterns and rows!</p>
    </section>

    <div class="panel">
      <div class="toolbar">
        <strong>Seeds:</strong>
        <button class="seed" data-id="tomato">🍅 Tomato</button>
        <button class="seed" data-id="carrot">🥕 Carrot</button>
        <button class="seed" data-id="corn">🌽 Corn</button>
        <button class="seed" data-id="lettuce">🥬 Lettuce</button>
        <button class="seed" data-id="flower">🌼 Flower</button>
        <span class="legend" style="margin-left:auto">Click a seed, then click cells. Use Erase to clear a cell.</span>
      </div>

      <div class="toolbar" style="margin-top:6px">
        <button class="btn" id="erase">Erase</button>
        <button class="btn" id="reset">Reset</button>
        <button class="btn btn--primary" id="export">Export Layout (JSON)</button>
        <a class="btn" href="/games/games.html" style="margin-left:auto">Back to Games</a>
      </div>

      <div id="board" class="board" style="grid-template-columns:repeat(10,1fr)"></div>
    </div>
  </main>

  <div id="footer"></div>

  <script>
    const SEEDS = {
      tomato: "🍅", carrot: "🥕", corn: "🌽", lettuce: "🥬", flower: "🌼"
    };
    const SIZE = 10; // 10x10 grid
    const $ = id => document.getElementById(id);

    let selected = null;
    let eraseMode = false;
    const state = Array.from({length: SIZE}, _ => Array(SIZE).fill(null));

    // seed buttons
    document.querySelectorAll('.seed').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        document.querySelectorAll('.seed').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        selected = btn.dataset.id; eraseMode = false;
        $('erase').classList.remove('btn--primary');
      });
    });

    $('erase').addEventListener('click', ()=>{
      eraseMode = !eraseMode;
      selected = null;
      document.querySelectorAll('.seed').forEach(b=>b.classList.remove('active'));
      $('erase').classList.toggle('btn--primary', eraseMode);
    });

    $('reset').addEventListener('click', ()=>{
      for (let r=0;r<SIZE;r++) for (let c=0;c<SIZE;c++) state[r][c]=null;
      paint();
    });

    $('export').addEventListener('click', ()=>{
      const data = { size: SIZE, layout: state };
      const blob = new Blob([JSON.stringify(data,null,2)], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'garden-layout.json'; a.click();
      URL.revokeObjectURL(url);
    });

    const board = $('board');
    function build(){
      board.innerHTML = '';
      for (let r=0;r<SIZE;r++){
        for (let c=0;c<SIZE;c++){
          const cell = document.createElement('button');
          cell.className = 'cell';
          cell.setAttribute('type','button');
          cell.dataset.r = r; cell.dataset.c = c;
          cell.addEventListener('click', onPlant);
          board.appendChild(cell);
        }
      }
      paint();
    }

    function onPlant(e){
      const r = +e.currentTarget.dataset.r;
      const c = +e.currentTarget.dataset.c;
      if (eraseMode){ state[r][c]=null; paintCell(r,c); return; }
      if (!selected) { alert('Pick a seed first, or use Erase'); return; }
      state[r][c] = selected;
      paintCell(r,c);
    }

    function paint(){
      for (let r=0;r<SIZE;r++){
        for (let c=0;c<SIZE;c++){ paintCell(r,c); }
      }
    }
    function paintCell(r,c){
      const i = r*SIZE + c;
      const el = board.children[i];
      const v = state[r][c];
      el.textContent = v ? SEEDS[v] : '';
    }

    build();
  </script>
</body>
</html>
